
/* AUTOGENERATED: rating.js */
CommonForm.elementControllers.push({pattern:'.product-average-rating-toggle',handler:function(){jQuery(this).hover(function(){jQuery('.product-average-rating-container').toggle()})}});CommonForm.elementControllers.push({pattern:'div.vote-bar',handler:function(){var $tooltip=jQuery(this).closest('div').parent().children('.rating-tooltip'),$div=jQuery(this).closest('div'),timeout;$div.hover(function(){timeout=setTimeout(function(){$tooltip.show(100)},250)},function(){clearTimeout(timeout);$tooltip.hide(100)})}});;
/* AUTOGENERATED: rating.js */
function VoteBarController(base){this.callSupermethod('constructor',arguments);var form=jQuery(this.base).closest('form').get(0);if(form)this.productId=jQuery('input[name=product_id]',form).eq(0).val();if(this.productId){this.returnTarget=jQuery('input[name=return_target]',form).eq(0).val();this.block=new VoteBarView(this.base,this.productId,this.returnTarget)}};extend(VoteBarController,AController);VoteBarController.prototype.name='VoteBarController';VoteBarController.prototype.findPattern='.product-average-rating';VoteBarController.prototype.block=null;VoteBarController.prototype.buttonsBlock=null;VoteBarController.prototype.initialize=function(){var o=this;this.base.bind('reload',function(event,box){event.stopImmediatePropagation();o.bind(box)})}
function VoteBarClick(obj){if(!obj._rating)obj._rating=parseInt(jQuery(obj).attr('class').match(/\d+/));jQuery(obj).closest('.vote-bar.editable').find('input[name=rating]').val(obj._rating);mainObj=jQuery(obj).closest('.vote-bar.editable').get(0);mainObj._rating=obj._rating;return false}
function VoteBarView(base,productId,returnTarget){this.callSupermethod('constructor',arguments);this.productId=productId;this.returnTarget=returnTarget;this.linkClickHandler=function(event){event.stopPropagation();return false}};extend(VoteBarView,ALoadable);VoteBarView.prototype.productId=null;VoteBarView.prototype.returnTarget=null;VoteBarView.prototype.rating=null;VoteBarView.prototype.shadeWidget=true;VoteBarView.prototype.widgetTarget='review';VoteBarView.prototype.widgetClass='\\XLite\\Module\\XC\\Reviews\\View\\AverageRating';VoteBarView.prototype.prevFormActionValue='';VoteBarView.prototype.prevFormActionInput=null;VoteBarView.prototype.prevShadeWidget=null;VoteBarView.prototype.postprocess=function(isSuccess,initial){this.callSupermethod('postprocess',arguments);if(isSuccess){var o=this,widgetClass=jQuery('input[name=target_widget]',o.base).eq(0).val();if(widgetClass)this.widgetClass=widgetClass;jQuery(this.base).find('.vote-bar.editable .stars-row.hovered .star-single').bind('click',function(event){VoteBarClick(this);return o.rateProduct(event,jQuery(this))});jQuery(this.base).bind('re-load',_.throttle(function(event){o.load()},1e3,{trailing:false}));this.base.closest('form').eq(0).commonController('bindElements')}};VoteBarView.prototype.getParams=function(params){params=this.callSupermethod('getParams',arguments);params.product_id=this.productId;if(this.widgetMode)params.widgetMode=this.widgetMode;return params};VoteBarView.prototype.rateProduct=_.throttle(function(event,block){var form=jQuery(block).closest('.product-average-rating'),rating=jQuery('input[name=rating]',form).eq(0).val();this.rating=rating;var productId=jQuery(block).closest('form').find('input[name=product_id]').eq(0).val();if(productId)this.productId=productId;var widgetMode=jQuery(block).closest('form').find('input[name=widgetMode]').eq(0).val();if(widgetMode)this.widgetMode=widgetMode;var blocksThatNeedToBeRefreshed;if(productId){blocksThatNeedToBeRefreshed=jQuery('input[name="product_id"]').filter(function(){return($(this).val()==productId)}).closest('form').filter(function(){return($(this).find(VoteBarController.prototype.findPattern).length>0)})}else blocksThatNeedToBeRefreshed=jQuery(block).closest('form');core.post(URLHandler.buildURL({target:'review',action:'rate'}),function(){jQuery(VoteBarController.prototype.findPattern,blocksThatNeedToBeRefreshed).trigger('re-load')},{product_id:productId,rating:rating});return false},1e3,{trailing:false});VoteBarView.prototype.postprocessRateProduct=function(XMLHttpRequest,textStatus,data,isValid){};core.autoload(VoteBarController);core.bind('list.products.postprocess',function(){core.autoload(VoteBarController)});core.bind('block.product.details.postprocess',function(){core.autoload(VoteBarController)});CommonForm.elementControllers.push({pattern:'.vote-bar.editable .stars-row.hovered .star-single',handler:function(){jQuery(this).hover(function(){if(!this._previous)this._previous=jQuery(this).prevAll();this._previous.each(function(index){jQuery(this).addClass('over')});jQuery(this).addClass('over')},function(){if(!this._previous)this._previous=jQuery(this).prevAll();this._previous.each(function(index){jQuery(this).removeClass('over')});jQuery(this).removeClass('over')}).click(function(){return VoteBarClick(this)})}});CommonForm.elementControllers.push({pattern:'.vote-bar.editable',handler:function(){jQuery(this).hover(function(){jQuery('.stars-row.hovered',this).show()},function(){if(!this._rating){if(!this._previous)this._previous=jQuery(this).children('.star-single');this._previous.each(function(index){jQuery(this).removeClass('over')});jQuery('.stars-row.hovered',this).hide()}else{var rating=this._rating;jQuery('.stars-row.hovered',this).find('.star-single').each(function(index){var j=parseInt(jQuery(this).attr('class').match(/\d+/));if(j>rating){jQuery(this).removeClass('over')}else jQuery(this).addClass('over')})}})}});CommonForm.elementControllers.push({pattern:'div.icon-help',handler:function(){var $tooltip=jQuery('#'+jQuery(this).attr('id')+'_tooltip');jQuery(this).hover(function(){$tooltip.css({display:'block'})},function(){$tooltip.css({display:'none'})})}});;
/* AUTOGENERATED: add_review.js */
function PopupButtonAddReview(){PopupButtonAddReview.superclass.constructor.apply(this,arguments)};extend(PopupButtonAddReview,PopupButton);PopupButtonAddReview.prototype.pattern='.add-review';PopupButton.prototype.enableBackgroundSubmit=false;core.autoload(PopupButtonAddReview);core.bind('block.product.details.postprocess',function(){core.autoload(PopupButtonAddReview)});core.bind('list.products.postprocess',function(){core.autoload(PopupButtonAddReview)});core.microhandlers.add('emailTooltip','.modify-review-dialog .tooltip-main .help-text',function(){attachTooltip(jQuery(this).closest('.tooltip-main').find('.help-icon'),jQuery(this).html())});;
/* AUTOGENERATED: controller.js */
function ProductQuantityBoxView(base){this.base=jQuery(base);if(this.base&&this.base.length&&this.base.find('input.quantity').length>0){this.block=this.base.find('input.quantity');var form=this.block.get(0).form;form.commonController.switchControlReadiness(true);form.commonController.bind('local.ready',_.bind(this.handleFormReady,this)).bind('local.unready',_.bind(this.handleFormUnready,this));this.block.on('input',_.bind(this.handleQuantityChange,this));this.isCartPage=jQuery('div#cart').length>0;if(!this.isCartPage){this.actionButton=jQuery(this.base).parents('div.product-buttons').find('button.add2cart, button.buy-more')}else this.actionButton=jQuery('ul.totals li.button button')};Base.apply(this,arguments);this.initialize()};extend(ProductQuantityBoxView,Base);ProductQuantityBoxView.prototype.base=null;ProductQuantityBoxView.prototype.block=null;ProductQuantityBoxView.prototype.isCartPage=false;ProductQuantityBoxView.prototype.initialize=function(){};ProductQuantityBoxView.prototype.handleQuantityChange=function(event){jQuery(event.currentTarget).change()};ProductQuantityBoxView.prototype.handleFormReady=function(event){this.actionButton.removeAttr('disabled').removeClass('disabled add2cart-disabled')};ProductQuantityBoxView.prototype.handleFormUnready=function(event){this.actionButton.prop('disabled','disabled').addClass('disabled add2cart-disabled')};ProductQuantityBoxView.prototype.getEventNamespace=function(){return'product.details.quantityBox'};core.registerTriggersBind('update-product-page',function(){var container=jQuery('span.quantity-box-container');new ProductQuantityBoxView(container);if(container.parents('form').get(0)&&container.parents('form').get(0).commonController)container.parents('form').get(0).commonController.bindElements()});core.registerShadowWidgets('update-product-page',function(){return'.widget-fingerprint-product-quantity, .widget-fingerprint-product-add-button'});;
/* AUTOGENERATED: script.js */
core.bind('load',function(){decorate('ProductDetailsView','postprocess',function(isSuccess,initial){arguments.callee.previousMethod.apply(this,arguments);if(isSuccess){jQuery('div.add-to-compare.product').mouseleave(function(){jQuery(this).find('div.compare-popup').removeClass('visible')});product_comparison()}})});;
/* AUTOGENERATED: items_list.js */
function ListsController(base){ListsController.superclass.constructor.apply(this,arguments);if(this.base&&this.base.length)this.block=this.getListView()};extend(ListsController,AController);ListsController.prototype.name='ItemsListController';ListsController.prototype.findPattern='.items-list';ListsController.prototype.block=null;ListsController.prototype.selfUpdated=false;ListsController.prototype.getListView=function(){return new ListView(this.base)};ListsController.prototype.initialize=function(){var o=this;this.base.bind('reload',function(event,box){o.bind(box)})}
function ListView(base){this.widgetClass=core.getCommentedData(base,'widget_class');this.widgetTarget=core.getCommentedData(base,'widget_target');this.widgetParams=core.getCommentedData(base,'widget_params');this.listenToHash=core.getCommentedData(base,'listenToHash');this.listenToHashPrefix=core.getCommentedData(base,'listenToHashPrefix');this.replaceState=core.getCommentedData(base,'replaceState');this.replaceStatePrefix=core.getCommentedData(base,'replaceStatePrefix');ListView.superclass.constructor.apply(this,arguments)};extend(ListView,ALoadable);ListView.prototype.shadeWidget=true;ListView.prototype.sessionCell=null;ListView.prototype.postprocess=function(isSuccess,initial){ListView.superclass.postprocess.apply(this,arguments);if(isSuccess){var o=this;jQuery('.pagination a',this.base).click(function(){jQuery('html, body').animate({scrollTop:o.base.offset().top});return!o.load({pageId:core.getValueFromClass(this,'page')})});jQuery('input.page-length').validationEngine();jQuery('input.page-length',this.base).change(function(){core.clearHash('pageId');if(!o.isLoading)if(!jQuery(this).validationEngine('validate')){count=parseInt(jQuery(this).val());if(isNaN(count)){count=10}else if(count<1)count=1;if(count!=jQuery(this).val())jQuery(this).val(count);o.load({itemsPerPage:count})}});jQuery('input.page-length',this.base).keypress(function(event){if(event.keyCode==13)jQuery(event.currentTarget).change()})}};
/* AUTOGENERATED: items_list.js */
decorate('ListView','postprocess',function(isSuccess,initial){arguments.callee.previousMethod.apply(this,arguments);if(isSuccess){var o=this;jQuery('.per-page-box .list-type-grid a',this.base).click(function(){jQuery('html, body').animate({scrollTop:o.base.offset().top});return!o.load({itemsPerPage:jQuery(this).data('items-per-page')})});jQuery('.product-cell > .product').mouseenter(function(){product=jQuery(this);productNameContainer=product.children("h5.product-name");productNameContainerHeight=parseInt(productNameContainer.css("line-height"),10)*2;productName=productNameContainer.children("a");productNameHeight=parseInt(productName.css("height"),10);productMargin=0;if(product.hasClass('low-stock')||product.hasClass('out-of-stock'))productMargin=productMargin-parseInt(product.find(".product-items-available").css("height"),10);if(product.find(".buttons-container").children().length)productMargin=productMargin-parseInt(product.find(".buttons-container").css("height"),10);if(productNameHeight>productNameContainerHeight){productNameDelta=productNameContainerHeight-productNameHeight;product.css({'margin-bottom':productMargin+productNameDelta+'px'})}}).mouseleave(function(){product=jQuery(this);product.removeAttr("style")})}});;
/* AUTOGENERATED: reviews_list.js */
function ReviewsListView(base){ReviewsListView.superclass.constructor.apply(this,arguments)};extend(ReviewsListView,ListView)
function ReviewsListController(base){ReviewsListController.superclass.constructor.apply(this,arguments)};extend(ReviewsListController,ListsController);ReviewsListController.prototype.name='ReviewsListController';ReviewsListController.prototype.findPattern='.items-list.product-reviews';ReviewsListController.prototype.getListView=function(){return new ReviewsListView(this.base)};ReviewsListView.prototype.getEventNamespace=function(){return'list.reviews'};core.autoload(ReviewsListController);;
/* AUTOGENERATED: subscribe.js */
function SubscribeBlockView(base){var args=Array.prototype.slice.call(arguments,0);this.callSupermethod('constructor',args);var form=this.base?this.base.find('.subscription-form-block form').get(0):null;if(form)form.commonController.enableBackgroundSubmit(undefined,_.bind(function(event,result){if(result.isValid&&result.textStatus==='success'){this.processSuccess()}else this.processError()},this))};extend(SubscribeBlockView,ALoadable);SubscribeBlockView.autoload=function(){jQuery('.subscription-block').each(function(){new SubscribeBlockView(this)})};SubscribeBlockView.prototype.widgetTarget='newsletter_subscriptions';SubscribeBlockView.prototype.widgetClass='\\XLite\\Module\\XC\\NewsletterSubscriptions\\View\\SubscribeBlock';SubscribeBlockView.prototype.processSuccess=function(){this.base.find('.subscription-form-block').hide();this.base.find('.subscription-error-block').hide();this.base.find('.subscription-success-block').removeClass('hidden');this.base.find('.subscription-success-block').show()};SubscribeBlockView.prototype.processError=function(){this.base.find('.subscription-error-block').removeClass('hidden');this.base.find('.subscription-error-block').show()};SubscribeBlockView.prototype.getEventNamespace=function(){return'NewsletterSubscriptions'};core.autoload(SubscribeBlockView);;
/* AUTOGENERATED: jquery_footer.js */
function mobileDropdown(){if(jQuery('#top-menu.dropdown-menu').hasClass('scrollable')==true)jQuery('#top-menu.dropdown-menu').removeClass('scrollable').removeAttr('style');var h1=jQuery(window).height(),h2=jQuery('#top-menu.dropdown-menu').height(),h3=jQuery('.mobile_header ul.nav-pills').height();if(h1<h2+h3)jQuery('#top-menu.dropdown-menu').addClass('scrollable').height(h1-h3)};jQuery(function(){mobileDropdown();jQuery(window).resize(mobileDropdown);jQuery(function(){jQuery('.top-main-menu a, .top-main-menu .primary-title').on('touchstart',function(e){if(jQuery(this).hasClass('tap')!==true&&jQuery(this).parent().parent().hasClass('tap')!==true)jQuery('ul.tap, a.tap, .primary-title.tap').removeClass('tap');if(jQuery(this).next('ul').length!==0){jQuery(this).toggleClass('tap');if(jQuery(this).hasClass('tap')==true)e.preventDefault();jQuery(this).next('ul').toggleClass('tap')};jQuery(document).on('touchstart',function(e){if(jQuery(e.target).closest('.tap').length==0)jQuery('ul.tap, a.tap, .primary-title.tap').removeClass('tap')})})})});;
/* AUTOGENERATED: flyout-menu.js */
jQuery(document).ready(function(){jQuery('ul.flyout-menu > li:not(.leaf) > a').on("touchstart",function(e){jQuery('ul.flyout-menu').addClass('touch');var link=jQuery(this),li=jQuery(this).parent();if(link.hasClass('hover')){li.addClass('hover');return true}else{link.addClass('hover');jQuery('ul.flyout-menu > li > a').not(this).removeClass('hover');li.closest('ul.flyout-menu').find('li').removeClass('hover');li.addClass('hover');e.preventDefault();return false}})});;